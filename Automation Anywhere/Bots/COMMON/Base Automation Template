{"triggers":[],"nodes":[{"uid":"89896c23-9659-437c-95fd-e81f94178a06","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"REQUIRED: Fill in the Automation Name and Folder Name fields in the lines below unless you're OK with auto-extraction. These values are used for folder/file naming in logging purposes."}}]},{"uid":"5b864cb4-875e-4450-b0b7-6e5d89f42423","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fa5a07fb-4dd3-4568-8aa9-4393c85b44aa","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Automation Name and Folder Name will drive logging - and are required to be filled. Additionaly, these values should be passed to a subtask (if subtasks are expected) or passed from a parent task if this bot will be called as a subtask."}}]},{"uid":"97187a29-1817-40c3-b12c-08847d2136b8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"4eaa005a-9b3a-4da2-9d9d-2e095a3d54b3","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"name":"delimiter","value":{"type":"STRING","string":"\\"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"lTaskPath"}},{"uid":"64447914-0dec-4d62-8cea-08f150379314","commandName":"listSize","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lTaskPath"}}],"returnTo":{"type":"VARIABLE","variableName":"nPathLength"}},{"uid":"38bd03c7-7eeb-48d7-8998-ac3ab6362191","commandName":"get","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lTaskPath"}},{"name":"itemPositionNumber","value":{"type":"NUMBER","expression":"$nPathLength$-1"}}],"returnTo":{"type":"VARIABLE","variableName":"sBotName"}},{"uid":"4d76f388-4e4e-4478-b1f7-3a3b0a7ae5e8","commandName":"get","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lTaskPath"}},{"name":"itemPositionNumber","value":{"type":"NUMBER","expression":"$nPathLength$-2"}}],"returnTo":{"type":"VARIABLE","variableName":"sFolderName"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get Task and Folder Name"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Verify Automation Name and Folder Name"}}]},{"uid":"3b04fec6-de4b-4e49-90d5-68eceff37844","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"128a8c20-6f1c-447a-ab4a-4e56e8c99972","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Automation logging root set by default to logging location used by the bot agent. See the variables pane for sRootLogDirectory."}}]},{"uid":"73514e70-8a33-4715-8599-784a783adf73","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRootLogDirectory$\\$sBotName$-$sFolderName$"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorFolder"}},{"uid":"bc7ae2ce-9d34-49c2-a640-52383583a39f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRootLogDirectory$\\$sBotName$-$sFolderName$\\Logs"}}],"returnTo":{"type":"VARIABLE","variableName":"sLogFolder"}},{"uid":"e6c3cd0f-beb6-4d0c-8e49-bb652d9f5b73","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRootLogDirectory$\\$sBotName$-$sFolderName$\\Snapshots"}}],"returnTo":{"type":"VARIABLE","variableName":"sSnapshotsFolder"}},{"uid":"85f0cc48-82d9-4fca-a5ea-d9a1473354f6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Creating default log/error directories specific to this automation"}}]},{"uid":"6d44e986-d4f2-4b56-988a-e460799430c0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"2a1ffe07-7a93-46ff-9c5a-914292e7a73f","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sRootLogDirectory$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sRootLogDirectory$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"7bb7d0bf-1c05-4d07-95ec-009ea15a4b9f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c2265f24-0c4a-4eda-9a17-49b6afb2ae78","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sErrorFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sErrorFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"411506ec-0b01-4259-bf55-ece5dd81d582","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"670a81ea-c3cb-45a1-89f8-63dd685a2975","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sLogFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sLogFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"a07c8322-89a5-45ba-9caa-d007ca57271b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ce71fde6-0655-4c9f-992f-c9e8cb9cd393","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sSnapshotsFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sSnapshotsFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"492c8e5b-1fec-40a1-98ec-bd47cff8c37e","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$System:Date$"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_DATE"}}],"returnTo":{"type":"VARIABLE","variableName":"sCurrentDate"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Setup Log Folders/Locations"}}]},{"uid":"c7e19961-755f-4f99-86ff-d0ce86e03f15","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"c06d1b13-0438-470f-b446-4693e63348d0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Setting lookback period for how long to keep logs for. Default is 30, can be customized as desired."}}]},{"uid":"d268f370-3182-4164-a28b-7ff908707f08","commandName":"subtract","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$System:Date$"}},{"name":"val","value":{"type":"NUMBER","expression":"$nLoggingPeriod$"}},{"name":"unit","value":{"type":"STRING","string":"DAYS"}}],"returnTo":{"type":"VARIABLE","variableName":"dtLogCutoffDate"}},{"uid":"60a43ec8-f2a7-40df-a07c-8cac5b42c6bb","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$dtLogCutoffDate$"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MM/dd/yy"}}],"returnTo":{"type":"VARIABLE","variableName":"sLogCutoffDate"}},{"uid":"de8792ef-cc48-4788-b530-fa80b2998499","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Surrounding delete actions in try handlers as to not cause the bot to fail its run in the case a log file couldnt be deleted. "}}]},{"uid":"95eab5af-9286-4078-a04e-dcfd077bad08","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"2b1ea342-5a3c-45e4-863e-93b4cc61c394","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Deleting all files from logs folder older than nLoggingPeriod days since last modification"}}]},{"uid":"78c4f069-4d23-48ac-bdfb-9c60f053fbf0","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/*.csv"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":true}},{"name":"dateValue","value":{"type":"STRING","string":"Modified"}},{"name":"dateRangeValue","value":{"type":"STRING","string":"Before"}},{"name":"beforeDate","value":{"type":"STRING","expression":"$sLogCutoffDate$"}},{"name":"isBeforeDateIncluded","value":{"boolean":false,"type":"BOOLEAN"}}]}],"branches":[]},{"uid":"49f2ef6c-2cfb-4df2-91f2-7059230c453a","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"97213a13-7d25-455d-ba76-dadd1ced8874","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Deleting all files from snapshots folder older than nLoggingPeriod days since last modification"}}]},{"uid":"719fd232-7bdb-41d2-8a7f-82144bb55a45","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sSnapshotsFolder$/*.jpg"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":true}},{"name":"dateValue","value":{"type":"STRING","string":"Modified"}},{"name":"dateRangeValue","value":{"type":"STRING","string":"Before"}},{"name":"beforeDate","value":{"type":"STRING","expression":"$sLogCutoffDate$"}},{"name":"isBeforeDateIncluded","value":{"boolean":false,"type":"BOOLEAN"}}]}],"branches":[]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Clear out old logs"}}]},{"uid":"2d733bef-a91a-4c63-8ef4-9ed343611949","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"fd0baa02-21cf-4f57-a182-fe50894399c8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*********Automation Logic Goes Inside Here************* "}}]}],"branches":[{"uid":"60be7a36-4aa8-4850-869c-7124d855a4e7","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"870b159c-92b5-4b73-84bd-c9797086fe72","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Logic Runs on Error"}}]},{"uid":"359d1a00-2680-453f-9079-60366eab4b05","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"11a68baf-d4fc-4d29-be81-fb8124bb15a5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ac14632f-e991-490f-ae24-7f197a732c05","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Creating file if it doesnt previously exist so that the header row can be created"}}]},{"uid":"b4b4cacf-06da-45ba-90fb-ec61a92eb192","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f0fc8a70-1eca-48f7-b767-c636f9cdeaea","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"logContent","value":{"type":"STRING","string":"Date,System,TaskName,ErrorLine,ErrorDescription"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"4b805343-189c-475a-93a4-526af84ff8e5","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"DATETIME","expression":"$System:Date$"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_DATE_TIME"}}],"returnTo":{"type":"VARIABLE","variableName":"sDateTime"}},{"uid":"601ef24d-c854-4e9a-bd8c-a63fbe0156d1","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLineNumber"}},{"uid":"07d66009-84d9-44fe-8ce5-75d22dcb57cf","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Logging error to file matching header row established format"}}]},{"uid":"6dd9e224-7f28-4f81-b2ce-a08be9b18d26","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$sDateTime$,$System:Machine$,$System:AATaskName$,$sErrorLineNumber$,\"$sErrorDescription$\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Log Error"}}]},{"uid":"45b7a25c-38c1-4a07-beec-d360bfca4dc9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ae16dc65-c123-48e1-9d12-ab68386efb8e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Taking snapshot. Please disable/remove this action if your screen could potential contain plain text PII"}}]},{"uid":"535851c4-9801-432a-8feb-79480f2eb598","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sSnapshotsFolder$/$sCurrentDate$_$sBotName$.jpg"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Record Snapshot"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"sRootLogDirectory","description":"Root directory for creating bot logs - can be customized or left as default","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\ProgramData\\AutomationAnywhere\\Bots\\Logs"}},{"name":"sErrorFolder","description":"Bot Specific Error Folder within Logging Root Directory","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sBotName","description":"REQUIRED: Bot Name (as listed in Bot Store) of the submitted Bot - doesn't have to match the file name of bot itself","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sFolderName","description":"REQUIRED: Parent Folder Name for Automation","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sLogFolder","description":"Log Folder Location for Bot Specific Logs","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sSnapshotsFolder","description":"Snapshot folder for Bot Specific Snapshots","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sErrorDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nErrorLineNumber","description":"Error Line Number as returned by the Catch Error Handler","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrorLineNumber","description":"String representation of the Error Line Number returned by the Catch Error Handler","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sCurrentDate","description":"Current Date used for Logging Purposes","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sDateTime","description":"Current Date/Time for use inside of Logging files","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nErrorTest","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"window-1","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"ESPN: Serving sports fans. Anytime. Anywhere. - Internet Explorer","path":"C:\\Program Files\\internet explorer\\iexplore.exe","class":"IEFrame","handle":"8127950","isChild":false,"location":{"top":-8,"left":-8},"size":{"height":951,"width":1936},"presetType":"NONE"}}},{"name":"dFileList","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"nLoggingPeriod","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"30"}},{"name":"dtLogCutoffDate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DATETIME","string":""}},{"name":"sLogCutoffDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sNull","description":"Empty value to check for the presence of empty strings","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"lTaskPath","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"nPathLength","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":[],"packages":[{"name":"Comment","version":"2.14.0"},{"name":"Datetime","version":"2.12.1"},{"name":"ErrorHandler","version":"2.11.3-20230316-162433"},{"name":"File","version":"6.7.0"},{"name":"Folder","version":"6.8.0"},{"name":"If","version":"3.6.2-20230316-161323"},{"name":"List","version":"2.11.0"},{"name":"LogToFile","version":"3.8.0"},{"name":"Number","version":"3.8.0"},{"name":"Screen","version":"2.9.2"},{"name":"Step","version":"2.5.0-20230105-135537"},{"name":"String","version":"5.8.0"},{"name":"System","version":"3.12.0"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":false,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}